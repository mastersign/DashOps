version: '2.0'
title: Test Project v2
logs: test-logs

pause-monitors: true
use-windows-terminal: true

# demo exec-paths

perspectives:
  - facet: host
    caption: Hosts
  - facet: service
    caption: Services
  - facet: verb
    caption: Verbs
  - facet: env
    caption: Environments

auto:
  - include:
      - mode: facet
        facet: host
        value: Localhost
    reassure: true
    use-windows-terminal: false
    no-execution-info: true

environment:
  ENV_A: Default Value A

actions:
  - description: List content of program files directory
    command: Get-ChildItem
    arguments: ['%ProgramFiles%']
    keep-open: true
    facets:
      host: Localhost
      service: File System
      verb: dir
      env: System
    tags:
      - Y
      - X
  - description: List content of user directory
    command: Get-ChildItem
    arguments: ['$env:UserProfile']
    logs: 'test-logs\user-files'
    background: true
    facets:
      host: Localhost
      service: File System
      verb: dir
      env: User
    tags:
      - Z
      - Y
action-discovery:
  - description: '${verb} ${service} on ${host}'
    base-path: "test-scripts\\"
    path-pattern: '(?<service>.+?)\\(?<verb>[^_]+)_(?<host>[^\.]+)\.ps1'
    arguments: ['a', 'b', 123]
    environment:
      ENV_A: Value A
      ENV_B: Value B
    facets:
      host: incorrect
      env: Test
    tags:
      - discovered
action-patterns:
  - description: 'Check ${service} on all hosts ${mode}'
    command: '${service}\check-all.ps1'
    arguments: ['-Mode', '${mode}']
    working-directory: test-scripts
    use-power-shell-core: true
    environment:
      ENV_B: value b
    always-close: true
    windows-terminal-args: [nt, --tabColor, '#C81', --title, 'Check ${service}']
    facets:
      service:
        - service A
        - service B
      mode: ['interactively', 'automatically', 'silently']
    tags:
     - expanded

default-monitor-interval: 10

monitors:
  - title: Monitor 1
    command: test-scripts\monitor-1.ps1
    arguments: [5]
    environment:
      ENV_MONITOR: Monitor 1

default-web-monitor-timeout: 5

web-monitors:
  - title: Monitor 2
    url: https://github.com
    required-patterns:
      - '<title>[^<>]*GitHub</title>'
    forbidden-patterns:
      - '<title>Google</title>'
